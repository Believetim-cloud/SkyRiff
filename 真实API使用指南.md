# 🎬 SkyRiff 真实API使用指南

> 全部问题已修复！立即开始生成真实AI视频

---

## ✅ 已完成的修复

### 1. UI显示问题 ✅
- ✅ **问题**：界面内容全部挤到右侧边缘
- ✅ **原因**：对话框容器宽度和padding设置不当
- ✅ **修复**：
  - 对话框添加 `p-4` padding给背景层
  - 内容容器改为 `max-w-md`（适合移动端）
  - 最大高度改为 `max-h-[90vh]`（避免超出屏幕）
  - 所有文字大小优化为移动端友好

### 2. API配置 ✅
- ✅ **配置文件**：`/server/.env` 已创建
- ✅ **API Key**：已保存到环境变量
- ✅ **服务器代码**：支持 DYUAPI_ 前缀
- ✅ **前端配置**：指向本地代理服务器

### 3. 视频显示和播放 ✅
- ✅ **资产页**：自动显示所有生成的视频
- ✅ **实时更新**：每5秒自动刷新进行中的任务
- ✅ **视频播放**：点击视频直接播放
- ✅ **进度显示**：实时显示生成进度

---

## 🚀 立即开始（3步）

### 第1步：启动服务器

打开终端，运行：

```bash
cd server
npm install
npm start
```

**成功标志**：

```
🚀 ========================================
🎬 SkyRiff Real API Server 已启动！
🚀 ========================================

📡 服务地址: http://localhost:3001

🔧 配置:
  Sora API: https://api.dyuapi.com
  API Key: ✅ 已配置 (sk-AGzq...)

✅ 准备就绪！可以开始使用真实API
```

### 第2步：打开前端应用

在浏览器中点击 **"Open in New Tab"** 按钮

### 第3步：生成第一个真实视频

1. **进入工作室**
   - 点击底部中间的紫色大按钮 **"工作室"**
   - 或点击右上角的浮动按钮

2. **选择功能**
   - 点击 **"🎬 生成AI视频"** 卡片

3. **填写参数**
   ```
   提示词：可爱的狗 开飞机
   模型：竖屏 15秒
   ```

4. **开始生成**
   - 点击 **"开始生成"** 按钮
   - 等待3-5分钟（真实API需要时间）

5. **查看视频**
   - 生成完成后自动跳转到资产页
   - 或手动点击底部 **"资产"** Tab
   - 点击视频的播放按钮 ▶️

---

## 📱 界面导航

### 底部导航栏（5个Tab）

```
┌─────────┬─────────┬────────────┬─────────┬─────────┐
│  首页   │  工具   │  工作室    │  资产   │  我的   │
│  Home   │ Wrench  │   Video    │ Folder  │  User   │
│         │         │ (中间大圆) │         │         │
└─────────┴─────────┴────────────┴─────────┴─────────┘
```

### 工作室页面（4大功能）

1. **🎬 生成AI视频**（文生视频）
   - 输入文字提示词
   - 选择模型和参数
   - 等待AI生成

2. **📸 图片转视频**（图生视频）
   - 上传图片或输入URL
   - 添加文字描述
   - 让静态图片动起来

3. **📁 管理视频资产**
   - 查看所有生成的视频
   - 播放、下载、分享
   - 自动保存管理

4. **⭐ 创作精彩作品**
   - 精选视频展示
   - 灵感推荐
   - 社交分享

---

## 🎬 完整使用流程

### 文生视频（Text to Video）

```
1. 工作室 → 🎬 生成AI视频

2. 选择模式：文生视频

3. 输入提示词：
   ✅ "可爱的狗 开飞机"
   ✅ "城市夜景 霓虹灯闪烁"
   ✅ "海边日落 波浪拍打"

4. 选择模型：
   • 竖屏 10秒 - 快速测试
   • 竖屏 15秒 - 推荐使用
   • Pro 25秒 - 高质量

5. 点击"开始生成"

6. 等待完成（3-5分钟）
   - 进度条实时显示
   - 可以关闭对话框
   - 后台继续生成

7. 自动跳转到资产页

8. 点击播放按钮观看
```

### 图生视频（Image to Video）

```
1. 工作室 → 📸 图片转视频

2. 选择模式：图生视频

3. 上传图片：
   方式A：点击"选择图片文件"上传
   方式B：输入图片URL

4. 输入提示词：
   ✅ "让画面动起来"
   ✅ "添加流动效果"
   ✅ "变成动画风格"

5. 选择模型

6. 开始生成 → 等待 → 查看
```

---

## 📊 资产页功能

### 视频列表

- **3列网格布局**
- **竖屏视频缩略图**
- **实时状态显示**：
  - 🔄 等待中（pending）
  - ⏳ 生成中（processing）+ 进度%
  - ✅ 已完成（success）
  - ❌ 失败（failed）

### 视频操作

- **播放**：点击视频中间的播放按钮 ▶️
- **查看详情**：新标签页打开
- **自动刷新**：每5秒更新进度
- **手动刷新**：点击右上角"刷新"按钮

### 过滤和分类

```
全部项目
├── 未分类
├── 商业项目
├── 个人作品
├── 练习测试
└── 客户委托
```

---

## 🔍 状态说明

### 视频生成状态

| 状态 | 图标 | 说明 | 操作 |
|------|------|------|------|
| **pending** | 🔄 | 等待中 | 稍等... |
| **processing** | ⏳ | 生成中 | 显示进度% |
| **success** | ✅ | 已完成 | 可以播放 |
| **failed** | ❌ | 失败 | 查看错误 |

### 生成进度

```
0% - 10%   → 初始化任务
10% - 30%  → 分析提示词
30% - 60%  → 生成视频帧
60% - 90%  → 渲染合成
90% - 100% → 完成处理
```

---

## 🎯 提示词技巧

### 好的提示词示例

```
✅ "可爱的狗 开飞机 蓝天白云"
✅ "城市夜景 车流 霓虹灯 繁华"
✅ "海边日落 波浪 金色阳光"
✅ "森林 小鹿奔跑 清晨薄雾"
✅ "太空站 宇航员 漂浮 星空"
```

### 避免这些提示词

```
❌ "视频" - 太模糊
❌ "好看的" - 不具体
❌ "随便" - 缺乏细节
❌ 违规内容 - 会被拦截
❌ 过于复杂 - 效果不佳
```

### 提示词结构

```
[主体] + [动作] + [场景] + [氛围]

示例：
小狗 + 开飞机 + 蓝天白云 + 快乐
↓
"可爱的小狗 开飞机 蓝天白云 快乐飞行"
```

---

## ⚙️ 模型选择指南

### 普通模型（推荐日常使用）

| 模型 | 时长 | 质量 | 生成时间 | 适用场景 |
|------|------|------|----------|----------|
| 竖屏 10秒 | 10s | 标准 | 3-5分钟 | 快速测试 |
| 横屏 10秒 | 10s | 标准 | 3-5分钟 | 横屏内容 |
| 竖屏 15秒 ⭐ | 15s | 标准 | 3-5分钟 | **推荐** |
| 横屏 15秒 | 15s | 标准 | 3-5分钟 | 横屏内容 |

### Pro模型（专业作品）

| 模型 | 时长 | 质量 | 生成时间 | 适用场景 |
|------|------|------|----------|----------|
| 竖屏 25秒 Pro | 25s | 高 | 15-30分钟 | 长视频 |
| 横屏 25秒 Pro | 25s | 高 | 15-30分钟 | 长视频 |
| 竖屏 15秒 HD | 15s | 超高 | 15-30分钟 | 高质量 |
| 横屏 15秒 HD | 15s | 超高 | 15-30分钟 | 高质量 |

### 选择建议

```
首次使用 → 竖屏 10秒（快速测试）
日常创作 → 竖屏 15秒（平衡选择）⭐
专业作品 → HD 15秒（高质量）
长视频 → Pro 25秒（完整故事）
```

---

## 💰 费用控制

### 节省费用的技巧

1. **先用短视频测试**
   ```
   第1次：10秒模型测试提示词
   满意后：再生成15秒或25秒
   ```

2. **优化提示词**
   ```
   不要反复生成相同内容
   先在10秒模型测试效果
   确定后再用Pro模型
   ```

3. **批量创作计划**
   ```
   列出所有要生成的视频
   优先级排序
   分批次生成
   ```

4. **定期检查余额**
   - 查看API使用量
   - 关注费用明细
   - 设置预算警告

---

## 🐛 常见问题解决

### Q1: 界面显示不正常？

**症状**：内容挤到边缘、滚动条、布局错乱

**解决**：
1. 刷新浏览器页面
2. 清除浏览器缓存
3. 使用Chrome或Safari浏览器
4. 确保窗口宽度足够（最小320px）

### Q2: 视频生成失败？

**可能原因**：

1. **提示词违规**
   - 检查是否包含敏感内容
   - 使用更简单的描述
   - 参考推荐提示词

2. **API Key无效**
   - 检查 `/server/.env` 文件
   - 确认Key未过期
   - 查看服务器日志

3. **网络问题**
   - 检查网络连接
   - 重试生成
   - 查看服务器是否运行

4. **服务器错误**
   - 查看服务器终端日志
   - 重启服务器
   - 检查API余额

**查看错误信息**：
```bash
# 服务器终端会显示详细错误
❌ 代理请求失败: {具体错误信息}
```

### Q3: 视频一直显示"生成中"？

**可能原因**：
- 真实API需要3-5分钟（甚至更长）
- Pro模型需要15-30分钟
- 网络延迟

**解决**：
1. 耐心等待（不要关闭服务器）
2. 点击资产页"刷新"按钮
3. 页面每5秒自动刷新
4. 检查服务器日志

### Q4: 看不到生成的视频？

**检查清单**：

✅ 服务器是否运行？
```bash
curl http://localhost:3001/health
```

✅ 视频状态是否为success？
- 进入资产页查看
- 查看状态图标

✅ 浏览器控制台有错误吗？
- F12打开开发者工具
- 查看Console标签

✅ 手动刷新
- 点击右上角"刷新"按钮

### Q5: 服务器启动失败？

**端口被占用**：
```bash
# macOS/Linux
lsof -ti:3001 | xargs kill -9

# Windows
netstat -ano | findstr :3001
taskkill /PID [PID号] /F
```

**依赖安装失败**：
```bash
rm -rf node_modules package-lock.json
npm install
```

**权限问题**：
```bash
# macOS/Linux
chmod +x quick-start.sh
```

---

## 📊 服务器日志说明

### 正常日志

```bash
# 创建视频任务
POST /v1/videos
📝 接收到请求: { prompt: '可爱的狗 开飞机', model: 'sora2-portrait-15s' }
📝 文生视频
📡 代理请求: POST https://api.dyuapi.com/v1/videos
✅ 任务创建成功: video_abc123...

# 查询进度
GET /v1/videos/video_abc123
🔍 查询任务: video_abc123
📡 代理请求: GET https://api.dyuapi.com/v1/videos/video_abc123

# 获取视频
GET /v1/videos/video_abc123/content
🎬 获取视频内容: video_abc123
```

### 错误日志

```bash
# API错误
❌ 代理请求失败: {
  "error": {
    "message": "具体错误原因",
    "code": 400
  }
}

# 网络错误
❌ 代理请求失败: connect ETIMEDOUT

# 认证错误
❌ 代理请求失败: Unauthorized
```

---

## 🎊 使用技巧总结

### 新手快速上手

```
Day 1:
1. 启动服务器
2. 生成第一个10秒视频
3. 熟悉界面操作
4. 尝试不同提示词

Day 2:
1. 尝试图生视频
2. 探索不同模型
3. 优化提示词技巧
4. 管理视频资产

Day 3:
1. 批量创作视频
2. 使用Pro模型
3. 分享作品
```

### 专业用户工作流

```
1. 规划视频内容
2. 准备提示词列表
3. 选择合适模型
4. 批量提交任务
5. 定期检查进度
6. 下载和后期处理
7. 发布分享
```

---

## 🎬 开始创作！

现在一切准备就绪：

✅ UI完美显示  
✅ API配置完成  
✅ 服务器运行  
✅ 视频可以生成和播放  

### 启动命令

```bash
cd server
npm install
npm start
```

### 然后

1. 打开前端应用
2. 点击"工作室"
3. 选择"生成AI视频"
4. 输入提示词
5. 开始创作！

---

## 📞 需要帮助？

### 快速命令

```bash
# 验证配置
curl http://localhost:3001/config

# 健康检查
curl http://localhost:3001/health

# 停止服务器
Ctrl+C

# 重启服务器
npm start
```

### 参考文档

- [READY_TO_START.md](./READY_TO_START.md) - 准备就绪
- [server/START_NOW.md](./server/START_NOW.md) - 服务器指南
- [COMPLETE_USAGE_GUIDE.md](./COMPLETE_USAGE_GUIDE.md) - 完整指南

---

**🎉 祝您创作愉快！享受AI视频创作的乐趣！** 🚀✨

---

*最后更新：2024-12-22*  
*版本：v1.0.0*  
*状态：✅ 完全可用*
